---

title: BigEarthNet Base Functions


keywords: fastai
sidebar: home_sidebar

summary: "A collection of common function that are applied to BEN."
description: "A collection of common function that are applied to BEN."
nb_path: "nbs/01b_base.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01b_base.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="BEN-JSON-helper-functions">BEN-JSON helper functions<a class="anchor-link" href="#BEN-JSON-helper-functions"> </a></h2><p>A couple of safe parsing functions that guarantee flexible reading of the default BigEarthNet json entries.</p>
<p>Usually, you should not use any of these parsing functions directly, but use one of the higher-level functions instead.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_datetime" class="doc_header"><code>parse_datetime</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L53" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_datetime</code>(<strong><code>inp</code></strong>:<code>Union</code>[<code>str</code>, <code>datetime</code>])</p>
</blockquote>
<p>Parses an input into a <code>datetime</code> object.
Will try its best to infer the correct format from a string.
If a <code>datetime</code> object is already provided it will be returned.
Otherwise it will raise an error.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d1</span> <span class="o">=</span> <span class="n">parse_datetime</span><span class="p">(</span><span class="s2">&quot;2017-06-13 10:10:31&quot;</span><span class="p">)</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">parse_datetime</span><span class="p">(</span><span class="s2">&quot;13.06.2017 10:10:31&quot;</span><span class="p">)</span>
<span class="n">d3</span> <span class="o">=</span> <span class="n">parse_datetime</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2017</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">31</span><span class="p">))</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">)</span>

<span class="k">with</span> <span class="n">ExceptionExpected</span><span class="p">(</span><span class="n">ex</span><span class="o">=</span><span class="n">ParserError</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="s2">&quot;format&quot;</span><span class="p">):</span>
    <span class="n">parse_datetime</span><span class="p">(</span><span class="s2">&quot;large_tile&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">ExceptionExpected</span><span class="p">(</span><span class="n">ex</span><span class="o">=</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="s2">&quot;parse&quot;</span><span class="p">):</span>
    <span class="n">parse_datetime</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">with</span> <span class="n">ExceptionExpected</span><span class="p">(</span><span class="n">ex</span><span class="o">=</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="s2">&quot;parse&quot;</span><span class="p">):</span>
    <span class="n">parse_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2017</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="box_from_ul_lr_coords" class="doc_header"><code>box_from_ul_lr_coords</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>box_from_ul_lr_coords</code>(<strong><code>ulx</code></strong>:<code>Real</code>, <strong><code>uly</code></strong>:<code>Real</code>, <strong><code>lrx</code></strong>:<code>Real</code>, <strong><code>lry</code></strong>:<code>Real</code>)</p>
</blockquote>
<p>Build a box (<code>Polygon</code>) from upper left x/y and lower right x/y coordinates.</p>
<p>This specification is the default BigEarthNet style.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b1</span> <span class="o">=</span> <span class="n">box_from_ul_lr_coords</span><span class="p">(</span><span class="n">ulx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">uly</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">lrx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">lry</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">b2</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">b1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Common-BEN-patch-checks-and-transformations">Common BEN patch checks and transformations<a class="anchor-link" href="#Common-BEN-patch-checks-and-transformations"> </a></h2><p>These tiny functions mainly allow the user to write cleaner code by importing them instead of writing lambda functions.
All functions use caches to guarantee fast lookups, so feel free to use them on large data.</p>
<p>The most relevant functions are:</p>
<ul>
<li>check if patch name in cloud/snow collection<ul>
<li><a href="/bigearthnet_common/base.html#is_snowy_patch"><code>is_snowy_patch</code></a></li>
<li><a href="/bigearthnet_common/base.html#is_cloudy_shadowy_patch"><code>is_cloudy_shadowy_patch</code></a></li>
</ul>
</li>
<li>Retrieve the original split by looking up the patch name<ul>
<li><a href="/bigearthnet_common/base.html#get_original_split_from_patch_name"><code>get_original_split_from_patch_name</code></a></li>
</ul>
</li>
<li>Convert the old 43-label nomenclature to the new 19-label variant<ul>
<li><a href="/bigearthnet_common/base.html#old2new_labels"><code>old2new_labels</code></a></li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_patches_with_seasonal_snow" class="doc_header"><code>get_patches_with_seasonal_snow</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_patches_with_seasonal_snow</code>(<strong><code>force_download</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>List all patches with seasonal snow from <strong>original</strong> BigEarthNet dataset.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_patches_with_cloud_and_shadow" class="doc_header"><code>get_patches_with_cloud_and_shadow</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L136" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_patches_with_cloud_and_shadow</code>(<strong><code>force_download</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>List all patches with cloud and shadow from <strong>original</strong> BigEarthNet dataset.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">snow_patches</span> <span class="o">=</span> <span class="n">get_patches_with_seasonal_snow</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">snow_patches</span><span class="p">)</span> <span class="o">==</span> <span class="n">ben_constants</span><span class="o">.</span><span class="n">BEN_SNOWY_PATCHES_COUNT</span>

<span class="n">cloud_and_shadow_patches</span> <span class="o">=</span> <span class="n">get_patches_with_cloud_and_shadow</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cloud_and_shadow_patches</span><span class="p">)</span> <span class="o">==</span> <span class="n">ben_constants</span><span class="o">.</span><span class="n">BEN_CLOUDY_OR_SHADOWY_PATCHES_COUNT</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_snowy_patch" class="doc_header"><code>is_snowy_patch</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_snowy_patch</code>(<strong><code>patch_name</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Fast function that checks whether <code>patch_name</code> is a patch
that contains a lot of seasonal snow.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_cloudy_shadowy_patch" class="doc_header"><code>is_cloudy_shadowy_patch</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L154" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_cloudy_shadowy_patch</code>(<strong><code>patch_name</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Fast function that checks whether <code>patch_name</code> is a patch
that contains a lot of shadow or is obstructed by clouds.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="patches_from_original_train_split" class="doc_header"><code>patches_from_original_train_split</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L164" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>patches_from_original_train_split</code>(<strong><code>split_url</code></strong>:<code>AnyHttpUrl</code>=<em><code>'https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/train.csv'</code></em>, <strong><code>force_download</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>List all train patches from the original train/validation/test split.
There are two possible sources:</p>
<ol>
<li><a href="https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/train.csv">https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/train.csv</a></li>
<li><a href="https://git.tu-berlin.de/rsim/BigEarthNet-S2_43-classes_models/-/raw/master/splits/train.csv">https://git.tu-berlin.de/rsim/BigEarthNet-S2_43-classes_models/-/raw/master/splits/train.csv</a></li>
</ol>
<p>While writing this function, there is <strong>no</strong> difference between these two splits.
But this may change in the future!</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="patches_from_original_validation_split" class="doc_header"><code>patches_from_original_validation_split</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L183" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>patches_from_original_validation_split</code>(<strong><code>split_url</code></strong>:<code>AnyHttpUrl</code>=<em><code>'https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/val.csv'</code></em>, <strong><code>force_download</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>List all validation patches from the original train/validation/test split.
There are two possible sources:</p>
<ol>
<li><a href="https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/train.csv">https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/train.csv</a>"</li>
<li>"<a href="https://git.tu-berlin.de/rsim/BigEarthNet-S2_43-classes_models/-/raw/master/splits/train.csv">https://git.tu-berlin.de/rsim/BigEarthNet-S2_43-classes_models/-/raw/master/splits/train.csv</a>"</li>
</ol>
<p>While writing this function, there is <strong>no</strong> difference between these two splits.
But this may change in the future!</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="patches_from_original_test_split" class="doc_header"><code>patches_from_original_test_split</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L202" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>patches_from_original_test_split</code>(<strong><code>split_url</code></strong>:<code>AnyHttpUrl</code>=<em><code>'https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/test.csv'</code></em>, <strong><code>force_download</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>List all test patches from the original train/validation/test split.
There are two possible sources:</p>
<ol>
<li><a href="https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/test.csv">https://git.tu-berlin.de/rsim/BigEarthNet-S2_19-classes_models/-/raw/master/splits/test.csv</a></li>
<li><a href="https://git.tu-berlin.de/rsim/BigEarthNet-S2_43-classes_models/-/raw/master/splits/test.csv">https://git.tu-berlin.de/rsim/BigEarthNet-S2_43-classes_models/-/raw/master/splits/test.csv</a></li>
</ol>
<p>While writing this function, there is <strong>no</strong> difference between these two splits.
But this may change in the future!</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_original_split_from_patch_name" class="doc_header"><code>get_original_split_from_patch_name</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L222" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_original_split_from_patch_name</code>(<strong><code>patch</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Returns "train"/"validation"/"test" or <code>None</code>.
The value is retrieved from the original BigEarthNet
train/validation/test split. If the input is not present
in any split, it will return <code>None</code> and raise a UserWarning.
This happens for patches that are either in the
cloud/shadow or seasonal snow set or if there exists no 19-label target.</p>
<p>The splits are from the 19-classes version.
While writing this function there was no difference between the
19-classes and the 43-classes version.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="s2">&quot;train&quot;</span> <span class="o">==</span> <span class="n">get_original_split_from_patch_name</span><span class="p">(</span><span class="s2">&quot;S2A_MSIL2A_20170717T113321_28_87&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;validation&quot;</span> <span class="o">==</span> <span class="n">get_original_split_from_patch_name</span><span class="p">(</span>
    <span class="s2">&quot;S2B_MSIL2A_20170812T092029_75_6&quot;</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;test&quot;</span> <span class="o">==</span> <span class="n">get_original_split_from_patch_name</span><span class="p">(</span><span class="s2">&quot;S2A_MSIL2A_20170717T113321_28_88&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="old2new_labels" class="doc_header"><code>old2new_labels</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L267" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>old2new_labels</code>(<strong><code>old_labels</code></strong>:<code>Sequence</code>[<code>str</code>])</p>
</blockquote>
<p>Converts a list of old-style BigEarthNet labels
to a list of labels.</p>
<p>If there are no corresponding new labels (which can happen with original BEN patches!)
then the function will return <code>None</code> and raise a user warning.</p>
<p>If an illegal/unknown input label is provided, a <code>KeyError</code> is raised.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include warning.html content='Some of the original 43-class nomenclature patches have 0 labels with the 19-class nomenclature! This function might return <code>None</code> instead of an empty list!' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ben_19_labels_to_multi_hot" class="doc_header"><code>ben_19_labels_to_multi_hot</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L290" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ben_19_labels_to_multi_hot</code>(<strong><code>labels</code></strong>:<code>Sequence</code>[<code>str</code>])</p>
</blockquote>
<p>Convenience function that converts an input sequence of labels into
a multi-hot encoded vector.
The naturally ordered label list is used as an encoder reference</p>
<ul>
<li><code>bigearthnet_common.NEW_LABELS</code></li>
</ul>
<p>If an unknown label is given, a <code>KeyError</code> is raised.</p>
<p>Be aware that this approach assumes that <strong>all</strong> labels are actually used in the dataset!
This is not necessarily the case if you are using a subset!
For example, the "Agro-forestry areas" class is only present in Portugal and in no other country!</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ben_43_labels_to_multi_hot" class="doc_header"><code>ben_43_labels_to_multi_hot</code><a href="https://github.com/k.clasen/bigearthnet_common/tree/main/bigearthnet_common/base.py#L309" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ben_43_labels_to_multi_hot</code>(<strong><code>labels</code></strong>:<code>Sequence</code>[<code>str</code>])</p>
</blockquote>
<p>Convenience function that converts an input sequence of labels into
a multi-hot encoded vector.
The naturally ordered label list is used as an encoder reference</p>
<ul>
<li><code>bigearthnet_common.OLD_LABELS</code></li>
</ul>
<p>If an unknown label is given, a <code>KeyError</code> is raised.</p>
<p>Be aware that this approach assumes that <strong>all</strong> labels are actually used in the dataset!
This is not necessarily the case if you are using a subset!
For example, the "Agro-forestry areas" class is only present in Portugal and in no other country!</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agro</span> <span class="o">=</span> <span class="n">ben_19_labels_to_multi_hot</span><span class="p">((</span><span class="s2">&quot;Agro-forestry areas&quot;</span><span class="p">,</span> <span class="p">))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">agro</span><span class="p">)</span> <span class="o">==</span> <span class="mi">19</span>
<span class="k">assert</span> <span class="n">agro</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">agro</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="n">multi</span> <span class="o">=</span> <span class="n">ben_19_labels_to_multi_hot</span><span class="p">((</span><span class="s2">&quot;Agro-forestry areas&quot;</span><span class="p">,</span> <span class="s2">&quot;Arable land&quot;</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">multi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="k">assert</span> <span class="n">multi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">multi</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

<span class="k">with</span> <span class="n">fc</span><span class="o">.</span><span class="n">ExceptionExpected</span><span class="p">(</span><span class="n">ex</span><span class="o">=</span><span class="ne">KeyError</span><span class="p">):</span>
    <span class="n">ben_19_labels_to_multi_hot</span><span class="p">([</span><span class="s2">&quot;Airports&quot;</span><span class="p">])</span>

<span class="n">agro43</span> <span class="o">=</span> <span class="n">ben_43_labels_to_multi_hot</span><span class="p">((</span><span class="s2">&quot;Agro-forestry areas&quot;</span><span class="p">,</span> <span class="p">))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">agro43</span><span class="p">)</span> <span class="o">==</span> <span class="mi">43</span>
<span class="k">assert</span> <span class="n">agro43</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">agro43</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="n">multi43</span> <span class="o">=</span> <span class="n">ben_43_labels_to_multi_hot</span><span class="p">((</span><span class="s2">&quot;Agro-forestry areas&quot;</span><span class="p">,</span> <span class="s2">&quot;Airports&quot;</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">multi43</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="k">assert</span> <span class="n">multi43</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">multi43</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

<span class="k">with</span> <span class="n">fc</span><span class="o">.</span><span class="n">ExceptionExpected</span><span class="p">(</span><span class="n">ex</span><span class="o">=</span><span class="ne">KeyError</span><span class="p">):</span>
    <span class="n">ben_43_labels_to_multi_hot</span><span class="p">([</span><span class="s2">&quot;Arable land&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

